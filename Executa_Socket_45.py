#encoding: iso-8859-1
import subprocess, os, sys
from subprocess import call


ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.1 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa1lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa1lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.2 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa2lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa2lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.3 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa3lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa3lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.4 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa4lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa4lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.5 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa5lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa5lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.6 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa6lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa6lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.7 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa7lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa7lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.8 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa8lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa8lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.9 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa9lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa9lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.10 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa10lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa10lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.11 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa11lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa11lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.12 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa12lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa12lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.13 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa13lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa13lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.14 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa14lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa14lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.15 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa15lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa15lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.16 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa16lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa16lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.17 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa17lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa17lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.18 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa18lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa18lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.19 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa19lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa19lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.20 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa20lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa20lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.21 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa21lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa21lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.22 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa22lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa22lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.23 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa23lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa23lj45")

ret = call("psexec.exe -d -i -u pdv\PDV -p pdv \\\\192.168.45.24 ""c:\\pdv\\renomeia.bat", shell=True)
print (ret)
if (ret == 2) or (ret == 53) or (ret == 1326) or (ret == 210):
	os.chdir('C:\\ATUAL')
	with open('Caixa24lj45.txt', 'a') as caixa:
		caixa.write('Não executado\n')
		caixa.close()
else:
	print("Executado Socket Caixa24lj45")


input ("Terminado, verificar na pasta ATUAL se existe caixas pendentes!!!")


